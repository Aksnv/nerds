"use strict";var overlay=document.querySelector(".overlay"),popup=document.querySelector(".popup"),openPopupButton=document.querySelector(".contacts__button"),closePopupButton=popup.querySelector(".popup__close-button"),feedbackForm=document.querySelector(".feedback-form"),feedbackFormFields=feedbackForm.querySelectorAll(".feedback-form__field"),feedbackFormFieldName=feedbackForm.querySelector(".feedback-form__field_name"),feedbackFormFieldEmail=feedbackForm.querySelector(".feedback-form__field_email"),feedbackFormFieldText=feedbackForm.querySelector(".feedback-form__field_text"),isStorageSupport=!0,storage="",expr=/(\w+)@(\w+)\.(\D+)/i,loseFocus=function(e){e.addEventListener("blur",function(){e.value&&e.classList.remove("feedback-form__field_invalid")})};try{storage=localStorage.getItem("name")}catch(e){isStorageSupport=!1}openPopupButton.addEventListener("click",function(e){e.preventDefault(),overlay.classList.add("overlay_visible"),popup.classList.add("popup_visible"),isStorageSupport&&(localStorage.getItem("name")?(feedbackFormFieldName.value=localStorage.getItem("name"),localStorage.getItem("email")?(feedbackFormFieldEmail.value=localStorage.getItem("email"),feedbackFormFieldText.focus()):feedbackFormFieldEmail.focus()):feedbackFormFieldName.focus())}),closePopupButton.addEventListener("click",function(e){e.preventDefault(),overlay.classList.remove("overlay_visible"),popup.classList.remove("popup_visible"),popup.classList.remove("popup_invalid")}),overlay.addEventListener("click",function(){overlay.classList.contains("overlay_visible")&&(overlay.classList.remove("overlay_visible"),popup.classList.remove("popup_visible"),popup.classList.remove("popup_invalid"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&popup.classList.contains("popup_visible")&&(e.preventDefault(),overlay.classList.remove("overlay_visible"),popup.classList.remove("popup_visible"),popup.classList.remove("popup_invalid"))}),feedbackForm.addEventListener("submit",function(e){e.preventDefault();for(var o=0,a=0;a<feedbackFormFields.length;a++)feedbackFormFields[a].value?feedbackFormFields[a].classList.remove("feedback-form__field_invalid"):(feedbackFormFields[a].classList.add("feedback-form__field_invalid"),o++);expr.test(feedbackFormFieldEmail.value)||(feedbackFormFieldEmail.classList.add("feedback-form__field_invalid"),o++),0===o?(isStorageSupport&&(localStorage.setItem("name",feedbackFormFieldName.value),localStorage.setItem("email",feedbackFormFieldEmail.value)),feedbackForm.submit()):(popup.classList.remove("popup_invalid"),popup.offsetWidth,popup.classList.add("popup_invalid"))}),loseFocus(feedbackFormFieldName),loseFocus(feedbackFormFieldEmail),loseFocus(feedbackFormFieldText);